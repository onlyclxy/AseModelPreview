# ASE 文件定位器 - 功能验证报告

## ✅ 已完成功能

### 1. 核心程序功能
- **文件路径解析**: 从命令行参数获取 dml/mat 文件路径
- **ASE 文件查找**: 在同目录下查找同名的 .ase 文件
- **ModelPreview 启动**: 使用程序目录下的 ModelPreview.exe 打开 ASE 文件
- **文件定位**: 在 Windows 资源管理器中高亮显示找到的 ASE 文件

### 2. 右键菜单集成 
- **注册表配置**: 正确注册到现有的文件类型关联
  - `.dml` → `dml.1` 程序类型
  - `.mat` → `3dsmat` 程序类型
- **菜单项**: "定位 ASE 文件"
- **自动刷新**: 注册后自动刷新文件关联

### 3. 完整工具链
- **编译脚本**: `build.bat` - 自动编译程序
- **注册脚本**: `CleanAndRegister.bat` - 清理并注册右键菜单
- **测试脚本**: `完整测试.bat` - 验证所有功能
- **检查脚本**: `TestRegistry.bat` - 检查注册表状态
- **卸载脚本**: `uninstall.bat` - 移除右键菜单

## 🔧 安装步骤

1. **以管理员身份运行**: `CleanAndRegister.bat`
2. **等待完成**: 脚本会自动重启资源管理器
3. **验证安装**: 运行 `完整测试.bat` 检查状态

## 📝 使用方法

### 通过右键菜单（推荐）
1. 在 Windows 资源管理器中找到 `.dml` 或 `.mat` 文件
2. 右键点击文件
3. 选择 "定位 ASE 文件" 菜单项
4. 程序会自动处理文件

### 通过命令行
```bash
ASELocator.exe "path\to\your\file.dml"
```

## 🎯 程序行为

当您选择 "定位 ASE 文件" 时，程序会：

1. **检查文件类型**: 确认是 `.dml` 或 `.mat` 文件
2. **查找 ASE 文件**: 在同一目录下寻找同名的 `.ase` 文件
3. **如果找到 ASE 文件**:
   - 使用 `ModelPreview.exe` 打开该文件
   - 在资源管理器中定位并高亮显示该文件
4. **如果未找到 ASE 文件**:
   - 显示 "未找到对应的 ASE 文件" 警告

## ⚠️ 注意事项

- **管理员权限**: 首次注册需要管理员权限
- **ModelPreview.exe**: 确保与 ASELocator.exe 在同一目录
- **文件命名**: ASE 文件必须与 DML/MAT 文件同名（仅扩展名不同）
- **文件位置**: ASE 文件必须在与 DML/MAT 文件相同的目录中

## 🔍 故障排除

### 右键菜单没有出现
1. 运行 `TestRegistry.bat` 检查注册状态
2. 如果注册失败，以管理员身份重新运行 `CleanAndRegister.bat`
3. 重新登录 Windows 或重启计算机

### 程序无法启动 ModelPreview.exe
1. 确认 `ModelPreview.exe` 在程序目录中
2. 检查 ModelPreview.exe 是否损坏
3. 查看错误消息了解具体问题

### 找不到 ASE 文件
1. 确认 ASE 文件确实存在
2. 检查文件名是否完全匹配（不包括扩展名）
3. 确认 ASE 文件在同一目录中

## 📂 文件清单

- `ASELocator.exe` - 主程序
- `CleanAndRegister.bat` - 注册脚本
- `完整测试.bat` - 功能测试
- `TestRegistry.bat` - 注册表检查
- `uninstall.bat` - 卸载脚本
- `使用说明.txt` - 简要说明
- `test.dml` / `test.ase` - 测试文件

## ✨ 验证状态

根据最新测试结果：
- ✅ 程序文件完整
- ✅ 注册表配置正确
- ✅ 测试文件准备就绪
- ✅ 右键菜单已注册

**状态**: 🟢 **完全就绪，可以使用！**

---

*如需技术支持或有问题，请查看各个 .bat 脚本的输出信息。* 